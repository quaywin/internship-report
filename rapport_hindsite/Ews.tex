\chapter{Easy Web Content Site builder.}

The Easy Web Content Site Builder, also called EWS, is the main project we are working. This project intends to complete the existing Easy Web Content service by enabling the user to create a new website from scratch.
%descriptopn of EWC
Basically The site builder will make extensive usage of ajax. The main directions of the project are
\begin{itemize}
\item Be the most simple in terms of user experience
\item propose simple to create but adapted styles and easy to customise
\item does not have the drawbacks of the concurrence
\item have the advantages of the concurrence
\item be scalable
\item be securized
\item target users : 2/3 of them have no HTML/CSS knowledge
\end{itemize}

%show a sample of the concurrence

\begin{wrapfigure}{l}{0.5\textwidth}
  \begin{center}
    \includegraphics[width=.40\textwidth]{img/ews_archi_before.png}
  \end{center}
\caption{Basic EWS architecture }
\end{wrapfigure}

\begin{wrapfigure}{r}{0.5\textwidth}
  \begin{center}
    \includegraphics[width=.40\textwidth]{img/ews_archi_after.png}
  \end{center}
\caption{EWS architecture rethink for cloud environment}
\end{wrapfigure}

\begin{figure}
  \centering
  \subfloat[A gull]{\label{fig:gull}\includegraphics[width=0.4\textwidth]{img/ews_archi_before.png}}
  \hspace{10pt}               
  \subfloat[A tiger]{\label{fig:tiger}\includegraphics[width=0.4\textwidth]{img/ews_archi_after.png}}
  \caption{Pictures of animals}
  \label{fig:animals}
\end{figure}

So the first stpe into the project was to brainstorm about the feasibility of the software. We did several research of was already existed in the market.
Writing downs the strengths and weaknesses of the most famous site builders. At the same time we specified the structure of the information system which
would allow the site builder to be scalable, and modular. We try to figure what was the best choices between achitecture and programmation languages.
After a week we decided to adopt PHP MySQL and Javascript instead of j2EE , GWT. The developers into the team are more familiar with these technologies.
So we designed a relational model for the MySQL database that matched our first expectations in term of page creation and page organisation.
%several illustrations of the models evolution



To allow scalability security and future cloud architecture, we decided to split the application into several databases inside the same MySQL server.
Inside the same MySQL server the databases can communicate easily with each other. So it allows to decouple these databases.
\begin{itemize}
\item a database to store common data
\item a database to manage users and sites
\item one database per site 
\end{itemize}
To allow better security, at the creation of a new site database ze create a specific MySQL user for this database which have specific permissisons
only on that database. It can acces common database data thru VIEWS.
% databases architecture illustration
After several meetings we decided to adopt a system that stores the informations of each pages created by the editor into a datababase.And then when
the user decides he will publish the pages that are converted in plain php or html pages.

\section{Web issues}

To understand the issues that arises when developing a web site or web application, let me first remind you how a user can access a web page.
\begin{itemize}
\item First, the client (the user's web browser) requests a web page located on a web server. The function of this web server is to deliver the requested web page to the client. This means delivery of an HTML document along with additional content, 
such as images, stylesheets and JavaScripts.
\item The client's web browser application then processes the content and displays it for the user.  
\end{itemize}

\begin{figure}[!l]
\centering
\includegraphics[width=.55\textwidth]{img/static.png}
\caption{Case of a static Html page}
\label{figure:static page}
\end{figure}
\begin{figure}[!r]
\centering
\includegraphics[width=.55\textwidth]{img/static.png}
\caption{Case of a dynamic page (for example a php page)}
\label{figure:dynamic page}
\end{figure}

While the server will always deliver the same content for the same requested page, two different users might see two different things on their computer. 
The reason is that there are more than one web browser software application existing, and while they try to make it look the same, the process behind the display and interpretation of the content is not. Set aside Html content, which is quite processed in the same way among every browsers, issues arises with interpretation of
JavaScript and Stylsheets (CSS). For example, Firefox will understand the CSS property moz-border-radius while Google Chrome and Internet Explorer will not. Also, Firefox will not understand the JavaScript Object window.event while Google Chrome and Internet Explorer will. There are dozens of example like these ones.
While you can develop the server side part of the application in one language and not worry about its ability to always deliver the same content, you can't afford to develop the client side application for only one browser. This would result in many internet users not to be able to see the content as intended.
\begin{figure}[!ht]
\centering
\includegraphics[width=.55\textwidth]{img/browser_statistics.png}
\caption{Market Share of Web Browser}
\label{figure:Market Share of Web Browser}
\end{figure}
And as a web development company, that is even less of an option. (your clients won't like that if you tell them that only 30 of the internet users will be able to use their website.)
Web application that behaves the same way in multiple browser are called "cross-browser". 
My job was of course to make sure that every web content I created was cross-browser (at least for IE7, IE8, Chrome and FF).
At first, this can look like a hard task to accomplish, because you would need to be aware of each browser specificities. Fortunately, some tools exists to help you reach that goal.

\subsubsection{JavaScript}

JavaScript has some big differences between browsers. For example, to attach an event to an element, Firefox and Chrome uses the function addEventListener. Internet Explorer will not understand this function as it uses attachEvent for the same purpose. %(cf Appendix page ## http://www.quirksmode.org/dom/w3c\_CSS.html).
Also, one of the purpose of JavaScript is being able to handle all the html elements in the web page to increase the user experience on the website. And again, there are some slight differences between every browser.
Because of all those disparities, people started to build APIs, which would considerably reduce the knowledge needed of those disparities to run a cross-browser JavaScript code. On of the most famous is jQuery. Simple, yet powerful, you can find in jQuery all the JavaScript functionalities, encapsulated in cross-browser functions. Ex: instead of having to test if the browser is IE to call the function attachEvent instead of addEventListener, you can just call the jQuery method bind to attach an event to an element. No need to learn the supported functions of each browser, you just need to learn a simple API. jQuery even simplifies some JavaScript functionalities, such as the use of Ajax.
%(cf piece of code w w/o jQuery).

\subsubsection{CSS}

Unlike in JavaScript, there is no API to help you with CSS (mainly because CSS is not a programming language). The huge issues in CSS arises when you want to make it work on Internet explorer. Usually, you are going to develop with Chrome or Firefox (Internet Explorer can be very slow so it can be frustrating to develop on it) where the same CSS is going to work on each other. It might even work in Internet Explorer 8 (with some really little adjustment on precise cases). But most of the time, you are going to have to do some adjustments so that it works on Internet Explorer 7. Those adjustment might be to just rethink the way of styling an element so that the same CSS will work on IE7 or completely tweaking the CSS just for Internet Explorer.
The last is called "CSS hacking". And fortunately, probably because Microsoft knows that his CSS handling is not that good, it introduced what is called conditional comments. It looks like a simple html comments in the html content, but IE knows it is aimed at him and can process it to add a specific Stylesheet. Other browsers will just ignore it, as it is a mere comment for them. (cg example html + speak about prefix * \_ etc.). 
\begin{figure}[!r]
\centering
\includegraphics[width=.55\textwidth]{img/comments.png}
\caption{Conditional Comment}
\label{figure:conditional comment}
\end{figure}
Another way to tweak the CSS specifically for Internet Explorer is to add a specific prefix to each CSS property you want to be applied only to some Internet Explorer Versions. (prefix * : IE 7 and below,prefix \_: IE6 and below). The downside of this is that it renders the CSS invalid to the W3C specification.

Understanding all that, you can understand why creating a site builder application is even more of a challenge. Indeed, we have to provide the user that has no understanding of html, CSS or JavaScript the ability to create a cross-browser website. And that was an important point, because it could give us an advantage against other competitors, who are not always cross-browser compliant.



